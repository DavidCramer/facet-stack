jQuery(function(a){a(document).on("click",".facet-stack-section-wrapper > h4",function(){var e=a(this),t=e.find(".facet-stack-section-toggle");e.closest(".facet-stack-wrapper");section=e.closest(".facet-stack-section-wrapper").find(".facet-stack-section"),t.hasClass("dashicons-arrow-up")?(t.removeClass("dashicons-arrow-up").addClass("dashicons-arrow-down"),section.slideUp(100)):(t.removeClass("dashicons-arrow-down").addClass("dashicons-arrow-up"),section.slideDown(100))});var e=function(e){var c=a("#"+e.data("for")),n=e.closest(".facet-stack-section"),s=n.find(".facet-stack-enabled-facets"),o=[];s.find(".facet-stack-facet").each(function(){o.push(a(this).data("facet"))}),t(s),console.log(c),c.length&&c.val(o.join(",")).trigger("change")},t=function(a){a.children().length>1?a.find(".description").slideUp(100):a.find(".description").slideDown(100)},c=function(c){c||(c=a(".facet-stack-facets")),c.sortable({connectWith:".facet-stack-tray",axis:"y",handle:".sortable-item",placeholder:"facet-stack-highlight-placeholder",forcePlaceholderSize:!0,helper:"clone",create:function(e,c){var n=a(this);n.hasClass("facet-stack-enabled-facets")&&t(n)},update:function(a,t){e(t.item)}})};a(document).on("widget-added widget-updated",function(a,e){var t=e.find(".facet-stack-facets");t.length&&c(t)}),c(),a(document).on("change",".facet-stack-section [data-bind]",function(e){e.stopPropagation();a(this)}),a(document).on("change",".facet-selector",function(n){var s=a(this),o=s.val(),i=s.parent(),d=i.parent(),f=d.find(".facet-stack-enabled-facets"),l=d.find('.facet-stack-facet[data-facet="'+o+'"]').clone();l.appendTo(f),s.val("").find('option[value="'+o+'"]').prop("disabled",!0),c(f),t(f),e(l)}),a(document).on("click",".facet-stack-remove",function(n){var s=a(this),o=s.data("facet"),i=s.closest(".facet-stack-facet"),d=s.closest(".facet-stack-section"),f=d.find(".facet-stack-enabled-facets"),l=d.find("select.facet-selector");i.remove(),l.find('option[value="'+o+'"]').prop("disabled",!1),c(f),t(f),e(d.find('.facet-stack-facet[data-facet="'+o+'"]'))})});